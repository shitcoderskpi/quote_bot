from asyncio import run
import json
from zstandard import ZstdCompressor, ZstdDecompressor
from json import loads
from base64 import b64decode
from term_image.image import KittyImage
from os import remove

from redis_controller import RedisQueue

compressor = ZstdCompressor(9)
decompressor = ZstdDecompressor()
data = r"""{
  "chat_id": -89574657,
  "template": "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"360\" height=\"110\" font-family=\"sans-serif\">\n  <defs>\n    <filter id=\"shadow\" x=\"-20%\" y=\"-20%\" width=\"140%\" height=\"140%\">\n      <feDropShadow dx=\"0\" dy=\"2\" stdDeviation=\"2\" flood-color=\"#000\" flood-opacity=\"0.15\"/>\n    </filter>\n  </defs>\n\n  <circle cx=\"19\" cy=\"19\" r=\"18\" fill=\"#ddd\" stroke=\"#aaa\" stroke-width=\"1\"/>\n\n  <image\n    href=\"data:image/png;base64,\data:image/png;base64,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\"\n    x=\"1\" y=\"1\"\n    width=\"36\" height=\"36\"\n    clip-path=\"url(#circle-clip)\"\n  />\n\n  <g filter=\"url(#shadow)\">\n    <rect\n      x=\"47\" y=\"0\"\n      width=\"260\" height=\"70\"\n      rx=\"16\" ry=\"16\"\n      fill=\"#fff\"\n      stroke=\"#ccc\"\n      stroke-width=\"1\"\n    />\n  </g>\n\n  <text x=\"56\" y=\"45\" font-size=\"13px\" fill=\"#000\">\n    но справедивости ради это в с++ 14 пофиксили\n  </text>\n  <text x=\"56\" y=\"23\" font-size=\"14px\" font-weight=\"bold\" fill=\"#2a5885\">SOLID</text>\n  <text x=\"300\" y=\"23\" font-size=\"12px\" fill=\"#888\" text-anchor=\"end\">пан оптимізатор</text>\n</svg>"
}"""


async def main():
    compressed_data = compressor.compress(data.encode("utf-8"))

    print(f"Original size: {len(data)} bytes")
    print(f"Compressed size: {len(compressed_data)} bytes")
    print(f"Compression ratio: {len(compressed_data)/len(data):.2f}")

    queue = RedisQueue()
    await queue.enqueue("generate:jobs", compressed_data)
    compressed = await queue.dequeue("generate:results")

    decompressed = decompressor.decompress(compressed[1])

    res = json.loads(decompressed)

    with open("output.webp", "wb") as f:
        f.write(b64decode(res.get("image")))
    img = KittyImage.from_file("output.webp")
    img.draw()
    remove("output.webp")


if __name__ == "__main__":
    run(main())
